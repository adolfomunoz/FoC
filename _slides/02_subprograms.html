---
title: Subprograms
---
<section>
    <section>
        <h1>Subprograms</h1>

		<p>A subprogram is a part of your program that implements an independent algorithm that
            can be used from different places within the rest of the program</p>

    </section>

    <section>
        <h2>Problem</h2>
        <blockquote>
        Develop a program that, given a number <b>n</b> of lines, 
        draws a triangle with asterisks (<code>'*'</code>).
        </blockquote>

        Example for <b>n=5</b>:

        <pre><code>
            *
           ***
          *****
         *******
        *********
        </code></pre> 
    </section>

    <section>
        <pre><code class="hljs cpp" data-trim data-line-numbers><script type="text/template">
        {%- include src/triangle/only-headers/triangle.cpp -%}

		</script></code></pre>
    </section>

    <section>
        <h2>Problem</h2>
        <blockquote>
        Develop a program that, given a numerator and denominator, 
        simplifies the rational number.
        </blockquote>
        <h2>Problem</h2>
        <blockquote>
        Develop a program that calculates the least common multiple
        of two given numbers.
        </blockquote>
    </section>

    <section>
        <pre><code class="hljs cpp" data-trim data-line-numbers><script type="text/template">
        {%- include src/gcf/simplify.cpp -%}

		</script></code></pre>

        <pre><code class="hljs cpp" data-trim data-line-numbers><script type="text/template">
        {%- include src/gcf/lcm.cpp -%}
    
        </script></code></pre>
    </section>

    <section>
        <h1>Subprograms</h1>
        {%- include img/subprogram.svg -%}
    </section>

	<section data-auto-animate>
		<p><strong>Specification :</strong>What does it do?</p>
        <img src="{{ site.baseurl }}/img/subprogram-specification.jpg"/>
    </section>

    <section data-auto-animate>
		<p><strong>Specification :</strong>What does it do?</p>
        {%- include img/subprogram-specification.svg -%}
    </section>

    <section data-auto-animate>
		<p><strong>Implementation :</strong>How does it do it?</p>
        <img src="{{ site.baseurl }}/img/subprogram-implementation.png"/>
    </section>

    <section data-auto-animate>
		<p><strong>Implementation :</strong>How does it do it?</p>
        {%- include img/subprogram-implementation.svg -%}
    </section>

    <section>
        <h1>Thinking with subprograms</h1>
        <ul>
            <li>Define a large problem as a composition of partial solutions from subproblems</li>
            <li>For each subproblem: develop its implementation or use implementation from others</li>
        </ul>
    </section>

    <section>
        <h3>Advantages</h3>
        <ul>
            <li>Legibility (shorter code)</li>
            <li>Mantainability (bugs/changes are easily located)</li>
            <li>You <strong>don't repeat yourself</strong></li>
        </ul>    
    </section>
</section>
<section>
    <section>
        <h2 class="r-fit-text">Subprograms</h2>
        <p class="r-fit-text">are represented in C++ as</p>
        <h2 class="r-fit-text">functions</h2>
    </section>
    <section data-auto-animate>
        <h2>Function specification</h2>
        <pre data-id="code-animation"><code class="hljs cpp" data-trim>
		    return_type function_name(type1 parameter1, type2 parameter2);	
		</code></pre>
    </section>
    <section data-auto-animate>
        <h2>Function specification</h2>
        <pre data-id="code-animation"><code class="hljs cpp" data-trim>
           /**
            * The function function_name does ...
            * parameter1 represents ...
            * parameter2 is ...
            * returns the result ...
            **/
		    return_type function_name(type1 parameter1, type2 parameter2);	
		</code></pre>
    </section>
    <section>
        <h2>Specification example</h2>
        <pre><code class="hljs cpp" data-trim>
            /**
             * The function repeat outputs the same charater a number of times.
             * 
             * n represents the number of times
             * c is the character that is repeated
             * The function returns nothing
             */
            void repeat(int n, char c);	
		</code></pre>
    </section>
    <section>
        <h2>Specification example</h2>
        <pre><code class="hljs cpp" data-trim>
            /**
             * The function gcf calculates the greatest common factor
             * between two numbers.
             * 
             * a y b are the two numbers
             * The function returns the calculated greatest common factor
             */
            int gcf(int a, int b);	
		</code></pre>
    </section>
    <section>
        <h2>Online documentation</h2>
        <h3><a href="http://github.com/antirez/smaz">link</a></h3>
    </section>
</section>

<section>
    <section>
        <h1>Copy vs Reference</h1>
    </section>

    <section>
        <p>What does this do? How is it different from previous examples?</p>
        
        <pre><code class="hljs cpp" data-trim data-line-numbers><script type="text/template">
            {%- include src/order3/order3.cpp -%}
    
        </script></code></pre>
    </section>
    <section data-auto-animate>
        <p>Parameters are copied, so they do not change. Does not work!</p>
        <pre data-id="code-animation"><code class="hljs cpp" data-trim>
            /**
             * Swaps real values 
             * 
             * a and b are the values to be swapped
             * Returns nothing
             */
            void swap(float a, float b);	
		</code></pre>
    </section>
    <section data-auto-animate>
        <p>Parameters are referenced, so they must be variables. Works!</p>
        <pre data-id="code-animation"><code class="hljs cpp" data-trim>
            /**
             * Swaps the real values of the variables 
             * 
             * a and b are references to the variables
             * Returns nothing
             */
            void swap(float& a, float& b);	
		</code></pre>
    </section>

    <section>
        <h1>Parameters by copy</h1>
        <p>By default: when invoking, values of arguments are
             copied to the corresponding parameters</p>
    </section>

    <section data-auto-animate>
        <h2>Parameters by copy</h2>
        <pre data-id="code-animation"><code class="hljs cpp" data-trim>
        float x = 5; float y = 3;
        swap(x,y);
        </code></pre>
        <ul>
            <li><code>a</code> gets the value of <code>x</code> (5)</li>
            <li><code>b</code> gets the value of <code>y</code> (3)</li>
        </ul>
        <pre><code class="hljs cpp" data-trim>
        void swap(float a, float b);
        </code></pre>        
    </section>

    <section data-auto-animate>
        <h2>Parameters by copy</h2>
        <pre data-id="code-animation"><code class="hljs cpp" data-trim>
        swap(5,3);
        </code></pre>
        <ul>
            <li><code>a</code> gets the value of <code>x</code> (5)</li>
            <li><code>b</code> gets the value of <code>y</code> (3)</li>
        </ul>
        <pre><code class="hljs cpp" data-trim>
        void swap(float a, float b);
        </code></pre>        
    </section>

    <section>
        <h1>Parameters by reference</h1>
        <p>When invoking, the argument variables are referenced (aliased).
           Whatever happens to the parameters happens to the variables</p>
        <ul class="fragment">
            <li>They work as <strong>output</strong> parameters.</li>
            <li>They are related to <strong>pointers</strong> (see later)</li>
        </ul>
    </section>
    <section data-auto-animate>
        <h2>Parameters by reference</h2>
        <pre data-id="code-animation"><code class="hljs cpp" data-trim>
        float x = 5; float y = 3;
        swap(x,y);
        </code></pre>
        <ul>
            <li><code>a</code> gets a reference to <code>x</code></li>
            <li><code>b</code> gets a reference to <code>y</code></li>
        </ul>
        <pre><code class="hljs cpp" data-trim>
        void swap(float& a, float& b);
        </code></pre>        
    </section>
    
    <section data-auto-animate>
        <h2>Parameters by reference</h2>
        <pre data-id="code-animation"><code class="hljs cpp" data-trim>
        float x = 5; float y = 3;
        swap(x,y);
        //swap(5,3) does not compile
        </code></pre>
        <ul>
            <li><code>a</code> gets a reference to <code>x</code></li>
            <li><code>b</code> gets a reference to <code>y</code></li>
        </ul>
        <pre><code class="hljs cpp" data-trim>
        void swap(float& a, float& b);
        </code></pre>        
    </section>
    
    <section data-auto-animate>
        <h2>Parameters by reference</h2>
        <pre data-id="code-animation"><code class="hljs cpp" data-trim>
        float x = 5; float y = 3;
        swap(x,y);
        //swap(5,3) does not compile
        </code></pre>
        <ul>
            <li>Whatever happens to <code>a</code> happens to <code>x</code></li>
            <li>Whatever happens to <code>b</code> happens to <code>y</code></li>
        </ul>
        <pre><code class="hljs cpp" data-trim>
        void swap(float& a, float& b);
        </code></pre>        
    </section>

    <section>
        <h2>Output parameter vs. return value</h2>
        <p>
            The output of a function can be represented as a reference parameter or as
            the return value of the function.
        </p>
    </section>

    <section>
        <table width="100%">
            <tr>
                <th width="50%">Output parameter</th>
                <th width="50%">Return value</th>
            </tr>
            <tr>
                <td width="50%">
                    <pre><code class="hljs cpp" data-trim>
                    void sqr(float x, float& x2);
                    </code></pre>
                </td>
                <td width="50%">
                    <pre><code class="hljs cpp" data-trim>
                    float sqr(float x);
                    </code></pre>
                </td>
            </tr>
            <tr class="fragment">
                <td width="50%">
                    <pre><code class="hljs cpp" data-trim>
                    float t; //t has a value
                    float t2_1;
                    sqr(t,t2_1);
                    t2_1 += 1;
                    </code></pre>
                </td>
                <td width="50%">
                    <pre><code class="hljs cpp" data-trim>
                            float t; // t has a value
                            float t2_1 = sqr(t) + 1;
                    </code></pre>
                </td>
            </tr>
        </table>
    </section>

    <section>
        <h2>Output parameter vs. return value</h2>
        <p>
            When possible, use return values instead of reference parameters.
        </p>
        <p class="fragment">
            When is that not possible?
        </p>
        <ul class="fragment">
            <li>When the function is given to you (you are not implementing it).</li>
            <li>When you have several values to return</li>
            <li>Low level efficiency/memory reasons (out of the scope of this course)</li>
        </ul> 
    </section>

    <section>
        <h2>Copy vs. reference: cost</h2>
        <ul>
            <li>Cost of copy proportional to data type's size</li>
            <li>Cost of reference is constant (always 64 bits)</li>
        </ul>
    </section>

    <section data-auto-animate>
        <h2>Copy vs. reference: cost</h2>
        <pre><code class="hljs cpp" data-trim>
            struct BigType {
                float v[1000000]; 
            }; 
        </code></pre>

        This is too costly:
        <pre><code class="hljs cpp" data-trim>
            void function(BigType bt);
        </code></pre>

        This might modify it (and sometimes I don't want to):
        <pre><code class="hljs cpp" data-trim>
            void function(BigType& bt);
        </code></pre>         
    </section>

    <section data-auto-animate>
        <h2>Copy vs. reference: cost</h2>
        <pre><code class="hljs cpp" data-trim>
            struct BigType {
                float v[1000000]; 
            }; 
        </code></pre>

        <pre><code class="hljs cpp" data-trim>
            void function(const BigType& bt);
        </code></pre>

        <p class="fragment">More about this later in this course</p>
    </section>
</section>

<section>
       <section data-auto-animate>
        <h2>Function implementation</h2>
        <pre data-id="code-animation"><code class="hljs cpp" data-trim>
		    return_type function_name(type1 parameter1, type2 parameter2);	
		</code></pre>
    </section>
    <section data-auto-animate>
        <h2>Function implementation</h2>
        <pre data-id="code-animation"><code class="hljs cpp" data-trim>
		    return_type function_name(type1 parameter1, type2 parameter2) {
                //Code that implements the behavior of the function
            } 
		</code></pre>
    </section>
    <section>
        <h2>Implementation example</h2>
        <pre><code class="hljs cpp" data-trim><script type="text/template">
            void repeat(int n, char c) {
                for (int i = 0;i < n;++i)
                    std::cout << c ;                
            } 	
		</script></code></pre>
    </section>
    <section>
        <h2>Implementation example</h2>
        <pre><code class="hljs cpp" data-trim><script type="text/template">
            int gcf(int a, int b) {
                if (b==0) return a;
                else return gcf(b,a%b);
            } 	
		</script></code></pre>
    </section>
    <section>
        <h2>Implementation example</h2>
        <pre><code class="hljs cpp" data-trim><script type="text/template">
            void swap(float& a, float& b) {
                float aux = a;
                a = b;
                b = aux;
            } 	
		</script></code></pre>
    </section>
    <section data-auto-animate>
        <h2>Distributing code</h2>
        <p>Where to locate the implementation code?</p>
    </section>

    <section data-auto-animate>
        <h2>Distributing code</h2>
        <p>Where to locate the code?</p>
        <ul>
            <li>Specification</li>
            <li>Implementation</li>
            <li>Main program</li>
        </ul>
    </section>

    <section data-auto-animate>
        <h2>Distributing code</h2>
        <h4>triangle.cpp</h4>
        <pre><code class="hljs cpp" data-trim data-line-numbers><script type="text/template">
            {%- include src/triangle/single-source/triangle.cpp -%}
        </script></code></pre>
    </section>

    <section data-auto-animate>
        <h2>Distributing code</h2>
        <table width="100%"><tr>
            <td width="50%">
                <h4>repeat.h</h4>
                <pre><code style="font-size:75%;line-height:0.85" class="hljs cpp" data-trim data-line-numbers><script type="text/template">
                    {%- include src/triangle/only-headers/repeat.h -%}
                </script></code></pre>
            </td>
            <td width="40%">
                <h4>triangle.cpp</h4>
                <pre><code style="font-size:75%;line-height:0.85" class="hljs cpp" data-trim data-line-numbers><script type="text/template">
                    {%- include src/triangle/only-headers/triangle.cpp -%}
                </script></code></pre>
            </td>        
        </tr></table>
    </section>

    <section data-auto-animate>
        <h2>Distributing code</h2>
        <table width="100%"><tr>
            <td width="50%">
                <h4>repeat.h</h4>
                <pre><code style="font-size:75%;line-height:0.85" class="hljs cpp" data-trim data-line-numbers><script type="text/template">
                    {%- include src/triangle/separate-implementation/repeat.h -%}
                </script></code></pre>
                <h4>repeat.cpp</h4>
                <pre><code style="font-size:75%;line-height:0.85" class="hljs cpp" data-trim data-line-numbers><script type="text/template">
                    {%- include src/triangle/separate-implementation/repeat.cpp -%}
                </script></code></pre>
            </td>
            <td width="40%">
                <h4>triangle.cpp</h4>
                <pre><code style="font-size:75%;line-height:0.85" class="hljs cpp" data-trim data-line-numbers><script type="text/template">
                    {%- include src/triangle/separate-implementation/triangle.cpp -%}
                </script></code></pre>
                <h4 class="fragment">Compile both <code>.cpp</code></h4>
                <pre class="fragment"><code style="font-size:75%"">
g++ repeat.cpp triangle.cpp -o triangle
                </code></pre>        
            </td>
        </tr></table>
    </section>
    <section>
        <h2>Compilation gets complex</h2>
        <div>
        <p>You need to compile all <code>.cpp</code> files</p>
        <pre><code>
            g++ repeat.cpp triangle.cpp -o triangle
        </code></pre>
        </div>
        <div class="fragment">
            <p>Better if done step by step (no need to recompile)</p>
            <pre><code>
                g++ repeat.cpp -c -o repeat.o
                g++ repeat.o triangle.cpp -o triangle
            </code></pre>
            <p>More about this later on this course</p>
            </div>
    </section>
</section>

<section>
    <section>
        <h1>Function testing</h1>
        <p>When implementing a function, do not integrate 
            with the rest of the software yet.</p>
        <h2>TEST IT</h2>
    </section>

    <section>
        <h1>Function testing</h1>
        <p><strong>How?</strong> Create another main program with the 
            only purpose of testing it.</p>
        <pre class="fragment"><code class="hljs cpp" data-trim data-line-numbers><script type="text/template">
            {%- include src/gcf/test.cpp -%}
        </script></code></pre>    
    </section>

    <section>
        <h1>Function testing</h1>
        <p>There are tools for facilitating the testing process</p>
        <ul class="fragment">
            <li><a href="https://google.github.io/googletest/">Google test</a></li>
            <li><a href="https://github.com/catchorg/Catch2">Catch2</a></li>
        </ul>
    </section>

    <section>
        <h1>Function testing</h1>
        <p>When to write the test code?</p>
        <ul>
            <li>After production code (traditional methodology)</li>
            <li>Before production code</li>
            <li>Parallel to production code (<a href="https://en.wikipedia.org/wiki/Test-driven_development">test-driven development</a>)</li>
        </ul>
    </section>
</section>